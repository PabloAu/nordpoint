<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rational Investing</title>
  <meta name="description" content="Evidence-based investing education. Learn how markets work and build a long-term portfolio you can manage yourself. Flat fee." />
  <meta name="theme-color" content="#c07a2a" />

  <style>
    :root{
      --bg:#f4f1ea;
      --ink:#1f1f1f;
      --muted:#5a5a5a;
      --line:rgba(0,0,0,.10);
      --accent:#c07a2a;
      --card:rgba(255,255,255,.62);

      /* Make the site feel wider */
      --max: 1360px;
      --r:16px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:var(--font);background:var(--bg);color:var(--ink)}
    a{color:inherit;text-decoration:none}
    a:hover{opacity:.86}

    /* top bar */
    .nav{
      position:sticky;top:0;z-index:50;
      background:rgba(244,241,234,.92);
      backdrop-filter: blur(8px);
      border-bottom:1px solid var(--line);
    }
    .navin{
      max-width:var(--max);
      margin:0 auto;
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;gap:14px;
    }
    .brand{display:flex;align-items:center;gap:10px;min-width:260px}
    .mark{
      width:30px;height:30px;border-radius:12px;
      border:1px solid var(--line);
      display:grid;place-items:center;
      background:linear-gradient(135deg, rgba(192,122,42,.14), rgba(192,122,42,.05));
      flex:0 0 auto;
    }
    .brandname{font-weight:700;letter-spacing:.2px;font-size:14px}
    .brandtag{font-size:12px;color:var(--muted);margin-top:2px}

    .links{display:flex;align-items:center;gap:16px;flex-wrap:wrap;justify-content:flex-end}
    .links a{font-size:13px;color:var(--muted);padding:8px 10px;border-radius:999px}
    .links a:hover{color:var(--ink);background:rgba(255,255,255,.35)}

    .lang{
      display:flex;align-items:center;
      border:1px solid var(--line);
      border-radius:999px;
      padding:8px 10px;
      background:rgba(255,255,255,.55);
    }
    select{border:0;background:transparent;font-size:13px;outline:none;cursor:pointer}

    /* Make the "Contact" top button milder */
    .btn{
      display:inline-flex;align-items:center;gap:8px;
      border-radius:999px;
      padding:10px 12px;
      font-size:13px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.55);
      color:var(--ink);
    }
    .btn:hover{background:rgba(255,255,255,.75)}

    /* layout */
    .wrap{max-width:var(--max);margin:0 auto;padding:56px 16px 84px}
    h1{
      margin:0;
      font-size:64px;
      line-height:1.02;
      letter-spacing:-.7px;
      /* make title span wide */
      max-width: 28ch;
    }
    @media(max-width:740px){h1{font-size:44px;max-width:18ch}}
    .accent-underline{
      display:inline-block;position:relative;padding:0 .06em;
    }
    .accent-underline::after{
      content:"";
      position:absolute;left:-2%;right:-2%;
      height:0.33em;bottom:0.08em;
      border:3px solid var(--accent);
      border-left:0;border-right:0;
      border-radius:999px;
      opacity:.95;
      pointer-events:none;
    }
    .lead{
      margin:18px 0 0;
      font-size:17px;
      line-height:1.75;
      color:var(--muted);
      /* make text span wide */
      max-width: 92ch;
    }

    section{margin-top:56px}
    .sectionhead{
      display:flex;align-items:flex-end;justify-content:space-between;gap:14px;
      margin-bottom:10px;
    }
    .sectionhead h2{margin:0;font-size:18px}
    .sectionhead span{color:var(--muted);font-size:13px}

    /* panels */
    .panel{
      border:1px solid var(--line);
      border-radius:var(--r);
      background:var(--card);
      padding:18px;
    }
    .panel h3{margin:0 0 10px;font-size:14px;letter-spacing:.2px}
    .panel p{margin:0;color:var(--muted);line-height:1.65;font-size:13px}
    .hr{height:1px;background:var(--line);margin:14px 0}
    .tiny{font-size:12px;color:var(--muted);line-height:1.6}

    ul{margin:0;padding-left:18px;color:var(--muted);line-height:1.7;font-size:13px}
    li{margin:6px 0}

    .stack{display:grid;gap:12px}

    .price{
      display:flex;justify-content:space-between;gap:16px;align-items:baseline;flex-wrap:wrap;
      margin-top:8px;color:var(--muted);font-size:12px
    }
    .price strong{color:var(--ink);font-weight:700}

    /* interactive controls */
    .controls{
      display:grid;
      grid-template-columns: 1.1fr 1fr 1fr;
      gap:12px;
      margin-bottom:12px;
    }
    @media(max-width:980px){.controls{grid-template-columns:1fr}}
    .field{
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.55);
      padding:12px;
    }
    .field label{display:block;font-size:12px;color:var(--muted);margin:0 0 8px}
    .field input[type="number"]{
      width:100%;
      border-radius:10px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.82);
      padding:10px 10px;
      font-size:13px;
      outline:none;
    }
    .field input[type="range"]{width:100%}
    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:980px){.row2{grid-template-columns:1fr}}

    /* chart */
    .chart{border:1px solid var(--line);border-radius:var(--r);background:var(--card);padding:14px}
    .legend{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
    .key{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:12px}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--muted)}
    .dot.a{background:var(--ink)}
    .dot.b{background:var(--accent)}
    .dot.c{background:rgba(31,31,31,.35)}
    .chartcap{
      display:flex;justify-content:space-between;gap:10px;align-items:baseline;margin-top:10px;flex-wrap:wrap
    }
    .chartcap strong{font-size:13px}
    .chartcap span{font-size:12px;color:var(--muted)}

    /* savings boxes */
    .savings{
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media(max-width:980px){.savings{grid-template-columns:1fr}}
    .savebox{
      border:1px solid var(--line);
      border-radius:14px;
      background:rgba(255,255,255,.55);
      padding:12px;
    }
    .savebox .t{font-size:12px;color:var(--muted)}
    .savebox .v{font-size:18px;font-weight:800;margin-top:4px}
    .savebox .s{font-size:12px;color:var(--muted);margin-top:4px;line-height:1.5}

    /* about */
    .about{
      display:grid;grid-template-columns:92px 1fr;gap:14px;align-items:start
    }
    @media(max-width:520px){.about{grid-template-columns:1fr}}
    .avatar{
      width:92px;height:92px;border-radius:999px;
      border:1px solid var(--line);
      overflow:hidden;background:linear-gradient(135deg, rgba(192,122,42,.18), rgba(0,0,0,.03));
    }
    .avatar img{width:100%;height:100%;object-fit:cover;display:block}

    /* form */
    label.form{display:block;font-size:12px;color:var(--muted);margin:12px 0 6px}
    input.form, textarea.form{
      width:100%;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.80);
      padding:12px 12px;
      font-size:13px;
      outline:none;
    }
    textarea.form{min-height:120px;resize:vertical}
    input.form:focus,textarea.form:focus{border-color:rgba(192,122,42,.55)}
    .formrow{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:720px){.formrow{grid-template-columns:1fr}}

    footer{margin-top:64px;padding-top:18px;border-top:1px solid var(--line);color:var(--muted);font-size:12px;line-height:1.6}
  </style>
</head>

<body>
  <header class="nav">
    <div class="navin">
      <div class="brand">
        <div class="mark" aria-hidden="true">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M5 14c3-6 11-6 14 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 4v16" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity=".85"/>
          </svg>
        </div>
        <div>
          <div class="brandname" data-i18n="brand.title">Rational Investing</div>
          <div class="brandtag" data-i18n="brand.sub">Evidence-based investing education • Flat fee</div>
        </div>
      </div>

      <nav class="links">
        <a href="#services" data-i18n="nav.services">Services</a>
        <a href="#why" data-i18n="nav.why">Why</a>
        <a href="#about" data-i18n="nav.about">About</a>
        <a href="#contact" class="btn" data-i18n="nav.contact">Contact</a>

        <div class="lang" title="Language">
          <select id="langSelect" aria-label="Language selector">
            <option value="en">EN</option>
            <option value="de">DE</option>
            <option value="fr">FR</option>
            <option value="it">IT</option>
            <option value="es">ES</option>
          </select>
        </div>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- HERO -->
    <section id="top">
      <h1 data-i18n="hero.h1">Learn how the <span class="accent-underline">market</span> works.</h1>

      <p class="lead" data-i18n="hero.lead">
        If you want to understand investing from scientific evidence, build a long-term plan, and manage it yourself,
        I can explain it clearly. You keep full control. You save money versus banks—and typically also versus robo-advisors
        that charge ~0.5% per year. I charge a flat fee.
      </p>

      <p class="tiny" style="margin-top:14px" data-i18n="hero.note">
        Educational service only. No custody. No discretionary management. No promises of returns.
      </p>
    </section>

    <!-- SERVICES -->
    <section id="services">
      <div class="sectionhead">
        <h2 data-i18n="services.title">Services</h2>
        <span data-i18n="services.sub">Simple, learning-first</span>
      </div>

      <div class="stack">
        <div class="panel">
          <h3 data-i18n="services.s1.h">Educational session (3 hours)</h3>
          <p data-i18n="services.s1.p">
            Markets, diversification, expected returns, risk, factor premiums, and the practical rules that make a plan sustainable.
            Swiss-friendly ETF selection with tax efficiency in mind.
          </p>
          <div class="price">
            <span data-i18n="services.s1.feeLabel">Flat fee</span>
            <strong data-i18n="services.s1.feeValue">CHF 1,200</strong>
          </div>
        </div>

        <div class="panel">
          <h3 data-i18n="services.s3.h">Optional yearly consultation (1 hour)</h3>
          <p data-i18n="services.s3.p">
            If your life changes, we keep the plan consistent and simple.
          </p>
          <div class="price">
            <span data-i18n="services.s3.feeLabel">Flat fee</span>
            <strong data-i18n="services.s3.feeValue">CHF 300</strong>
          </div>
        </div>
      </div>
    </section>

    <!-- WHY + INTERACTIVE GRAPH -->
    <section id="why">
      <div class="sectionhead">
        <h2 data-i18n="why.title">Why this exists</h2>
        <span data-i18n="why.sub">Knowledge + compounding</span>
      </div>

      <div class="stack">
        <div class="panel">
          <h3 data-i18n="why.h">A few things are actually known</h3>
          <ul>
            <li data-i18n="why.li1">There is strong long-term evidence about diversified investing, but it works over decades—not months.</li>
            <li data-i18n="why.li2">Understanding markets and macroeconomics is useful practically—and genuinely interesting intellectually.</li>
            <li data-i18n="why.li3">With knowledge and a portfolio design, you can plan your life better: expected returns and volatility translate into probabilities, not certainties.</li>
            <li data-i18n="why.li4">You can save ongoing fees (e.g., ~0.5%/year vs many robo-advisors). You can also tilt toward factor premiums to potentially improve expected returns (with uncertainty).</li>
          </ul>
        </div>

        <div class="chart">
          <div class="controls" aria-label="Interactive inputs">
            <div class="field">
              <label data-i18n="why.ctrl.base">Expected nominal return (fixed)</label>
              <div style="display:flex;justify-content:space-between;gap:10px;align-items:baseline">
                <div style="font-weight:800">8%</div>
                <div class="tiny" data-i18n="why.ctrl.baseNote">Illustration only</div>
              </div>
              <div class="hr"></div>
              <div class="tiny" data-i18n="why.ctrl.baseNote2">
                Returns are uncertain; fees are not. This tool visualizes fee drag under a simplifying constant-return assumption.
              </div>
            </div>

            <div class="field">
              <label data-i18n="why.ctrl.lump">Initial amount (CHF)</label>
              <input id="inpLump" type="number" min="0" step="1000" value="100000" />
              <div class="hr"></div>
              <label data-i18n="why.ctrl.month">Monthly contribution (CHF)</label>
              <input id="inpMonthly" type="number" min="0" step="100" value="2000" />
            </div>

            <div class="field">
              <div class="row2">
                <div>
                  <label data-i18n="why.ctrl.robo">Robo-advisor fee (%/year)</label>
                  <input id="inpRobo" type="number" min="0" max="5" step="0.05" value="0.5" />
                </div>
                <div>
                  <label data-i18n="why.ctrl.bank">Bank fee (%/year)</label>
                  <input id="inpBank" type="number" min="0" max="5" step="0.05" value="1.0" />
                </div>
              </div>
              <div class="hr"></div>
              <div class="tiny" data-i18n="why.ctrl.tip">
                Tip: change values and the plot + savings update instantly.
              </div>
            </div>
          </div>

          <svg id="chartSvg" viewBox="0 0 780 360" width="100%" height="auto" role="img" aria-label="Wealth projection chart">
            <!-- drawn by JS -->
          </svg>

          <div class="legend">
            <div class="key"><span class="dot a"></span><span data-i18n="why.legend.self">Self-managed (0% advisory fee)</span></div>
            <div class="key"><span class="dot b"></span><span data-i18n="why.legend.robo">Robo-advisor (fee slider)</span></div>
            <div class="key"><span class="dot c"></span><span data-i18n="why.legend.bank">Bank (fee slider)</span></div>
          </div>

          <div class="chartcap">
            <strong data-i18n="why.caption.h">Interactive illustration (8% nominal return assumption)</strong>
            <span data-i18n="why.caption.s">Shows how yearly fees compound against you over 10–30 years.</span>
          </div>

          <div class="savings" aria-label="Savings summary">
            <div class="savebox">
              <div class="t" data-i18n="why.save10.t">At 10 years</div>
              <div class="v" id="save10">—</div>
              <div class="s" id="save10sub">—</div>
            </div>
            <div class="savebox">
              <div class="t" data-i18n="why.save20.t">At 20 years</div>
              <div class="v" id="save20">—</div>
              <div class="s" id="save20sub">—</div>
            </div>
            <div class="savebox">
              <div class="t" data-i18n="why.save30.t">At 30 years</div>
              <div class="v" id="save30">—</div>
              <div class="s" id="save30sub">—</div>
            </div>
          </div>

          <p class="tiny" style="margin-top:12px" data-i18n="why.note">
            This is not a forecast. It’s a fee illustration under a constant-return assumption to make compounding intuitive.
          </p>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about">
      <div class="sectionhead">
        <h2 data-i18n="about.title">About</h2>
        <span data-i18n="about.sub">ETH Zürich • biophysics</span>
      </div>

      <div class="panel">
        <div class="about">
          <div class="avatar" aria-label="Profile photo">
            <img src="Pablo.jpg" alt="Pablo Aurelio" />
          </div>

          <div>
            <h3 data-i18n="about.h">Who I am</h3>
            <p data-i18n="about.p">
              I’m a scientist at ETH Zürich (biophysics). I’m also passionate about economics and long-term investing, and I spent years studying the evidence behind how markets work.
              I built this service for people who want clarity, autonomy, and a simple process they can keep for life.
            </p>
            <div class="hr"></div>
            <p class="tiny">
              <a id="linkedinLink" href="https://www.linkedin.com/in/pablo-aurelio/" target="_blank" rel="noopener noreferrer">
                <span data-i18n="about.linkedinText">LinkedIn</span>
              </a>
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact">
      <div class="sectionhead">
        <h2 data-i18n="contact.title">Contact</h2>
        <span data-i18n="contact.sub">Short message, then a fit check</span>
      </div>

      <div class="stack">
        <div class="panel">
          <h3 data-i18n="contact.h">Send a message</h3>
          <p class="tiny" data-i18n="contact.p">
            Horizon, current approach, and what you want to learn is enough.
          </p>

          <form action="https://formspree.io/f/mnjqadnq" method="POST">
            <div class="formrow">
              <div>
                <label class="form" data-i18n="contact.nameL">Name</label>
                <input class="form" name="name" required data-i18n-ph="contact.nameP" placeholder="Your name" />
              </div>
              <div>
                <label class="form" data-i18n="contact.emailL">Email</label>
                <input class="form" name="email" type="email" required data-i18n-ph="contact.emailP" placeholder="you@email.com" />
              </div>
            </div>

            <label class="form" data-i18n="contact.msgL">Message</label>
            <textarea class="form" name="message" required data-i18n-ph="contact.msgP" placeholder=""></textarea>

            <div style="margin-top:12px">
              <button class="btn" type="submit" data-i18n="contact.send">Send</button>
              <span class="tiny" style="margin-left:10px" data-i18n="contact.note">Formspree may ask you to confirm your email on first use.</span>
            </div>
          </form>
        </div>

        <div class="panel">
          <h3 data-i18n="legal.h">Important notice</h3>
          <p class="tiny" data-i18n="legal.p">
            Educational and informational service only. No discretionary management, no custody, no commissions, no promises of returns.
            You retain full responsibility, control, and custody of your assets.
          </p>
        </div>
      </div>
    </section>

    <footer>
      <div>© <span id="year"></span> <span data-i18n="brand.title">Rational Investing</span></div>
    </footer>
  </main>

  <script>
    // ---------------------------
    // Minimal i18n (EN/DE/FR/IT/ES)
    // ---------------------------
    const I18N = {
      en: {
        "brand.title":"Rational Investing",
        "brand.sub":"Evidence-based investing education • Flat fee",

        "nav.services":"Services",
        "nav.why":"Why",
        "nav.about":"About",
        "nav.contact":"Contact",

        "hero.h1":"Learn how the <span class='accent-underline'>market</span> works.",
        "hero.lead":"If you want to understand investing from scientific evidence, build a long-term plan, and manage it yourself, I can explain it clearly. You keep full control. You save money versus banks—and typically also versus robo-advisors that charge ~0.5% per year. I charge a flat fee.",
        "hero.note":"Educational service only. No custody. No discretionary management. No promises of returns.",

        "services.title":"Services",
        "services.sub":"Simple, learning-first",
        "services.s1.h":"Educational session (3 hours)",
        "services.s1.p":"Markets, diversification, expected returns, risk, factor premiums, and the practical rules that make a plan sustainable. Swiss-friendly ETF selection with tax efficiency in mind.",
        "services.s1.feeLabel":"Flat fee",
        "services.s1.feeValue":"CHF 1,200",

        "services.s3.h":"Optional yearly consultation (1 hour)",
        "services.s3.p":"If your life changes, we keep the plan consistent and simple.",
        "services.s3.feeLabel":"Flat fee",
        "services.s3.feeValue":"CHF 300",

        "why.title":"Why this exists",
        "why.sub":"Knowledge + compounding",
        "why.h":"A few things are actually known",
        "why.li1":"There is strong long-term evidence about diversified investing, but it works over decades—not months.",
        "why.li2":"Understanding markets and macroeconomics is useful practically—and genuinely interesting intellectually.",
        "why.li3":"With knowledge and a portfolio design, you can plan your life better: expected returns and volatility translate into probabilities, not certainties.",
        "why.li4":"You can save ongoing fees (e.g., ~0.5%/year vs many robo-advisors). You can also tilt toward factor premiums to potentially improve expected returns (with uncertainty).",

        "why.ctrl.base":"Expected nominal return (fixed)",
        "why.ctrl.baseNote":"Illustration only",
        "why.ctrl.baseNote2":"Returns are uncertain; fees are not. This tool visualizes fee drag under a simplifying constant-return assumption.",
        "why.ctrl.lump":"Initial amount (CHF)",
        "why.ctrl.month":"Monthly contribution (CHF)",
        "why.ctrl.robo":"Robo-advisor fee (%/year)",
        "why.ctrl.bank":"Bank fee (%/year)",
        "why.ctrl.tip":"Tip: change values and the plot + savings update instantly.",

        "why.legend.self":"Self-managed (0% advisory fee)",
        "why.legend.robo":"Robo-advisor (fee slider)",
        "why.legend.bank":"Bank (fee slider)",

        "why.caption.h":"Interactive illustration (8% nominal return assumption)",
        "why.caption.s":"Shows how yearly fees compound against you over 10–30 years.",

        "why.save10.t":"At 10 years",
        "why.save20.t":"At 20 years",
        "why.save30.t":"At 30 years",

        "why.note":"This is not a forecast. It’s a fee illustration under a constant-return assumption to make compounding intuitive.",

        "about.title":"About",
        "about.sub":"ETH Zürich • biophysics",
        "about.h":"Who I am",
        "about.p":"I’m a scientist at ETH Zürich (biophysics). I’m also passionate about economics and long-term investing, and I spent years studying the evidence behind how markets work. I built this service for people who want clarity, autonomy, and a simple process they can keep for life.",
        "about.linkedinText":"LinkedIn",

        "contact.title":"Contact",
        "contact.sub":"Short message, then a fit check",
        "contact.h":"Send a message",
        "contact.p":"Horizon, current approach, and what you want to learn is enough.",
        "contact.nameL":"Name",
        "contact.emailL":"Email",
        "contact.msgL":"Message",
        "contact.send":"Send",
        "contact.note":"Formspree may ask you to confirm your email on first use.",
        "contact.nameP":"Your name",
        "contact.emailP":"you@email.com",
        "contact.msgP":"",

        "legal.h":"Important notice",
        "legal.p":"Educational and informational service only. No discretionary management, no custody, no commissions, no promises of returns. You retain full responsibility, control, and custody of your assets."
      },

      // For brevity in this version, other languages reuse EN text.
      // If you want, I can paste full DE/FR/IT/ES translations again.
      de: {}, fr: {}, it: {}, es: {}
    };

    function applyLang(lang){
      const base = I18N.en;
      const dict = Object.assign({}, base, I18N[lang] || {});
      document.querySelectorAll("[data-i18n]").forEach(el=>{
        const k = el.getAttribute("data-i18n");
        if(dict[k] !== undefined) el.innerHTML = dict[k];
      });
      document.querySelectorAll("[data-i18n-ph]").forEach(el=>{
        const k = el.getAttribute("data-i18n-ph");
        if(dict[k] !== undefined) el.setAttribute("placeholder", dict[k]);
      });
      document.documentElement.lang = lang;
      localStorage.setItem("ri_lang", lang);
    }

    // init language
    const saved = localStorage.getItem("ri_lang");
    const browserLang = (navigator.language || "en").slice(0,2);
    const initial = saved || ((I18N[browserLang] && Object.keys(I18N[browserLang]).length) ? browserLang : "en");
    const selectLang = document.getElementById("langSelect");
    selectLang.value = (["en","de","fr","it","es"].includes(initial)) ? initial : "en";
    applyLang(selectLang.value);
    selectLang.addEventListener("change", e => applyLang(e.target.value));

    // year
    document.getElementById("year").textContent = new Date().getFullYear();

    // ---------------------------
    // Interactive chart math + rendering
    // ---------------------------
    const svg = document.getElementById("chartSvg");
    const elLump = document.getElementById("inpLump");
    const elMonthly = document.getElementById("inpMonthly");
    const elRobo = document.getElementById("inpRobo");
    const elBank = document.getElementById("inpBank");

    const save10 = document.getElementById("save10");
    const save20 = document.getElementById("save20");
    const save30 = document.getElementById("save30");
    const save10sub = document.getElementById("save10sub");
    const save20sub = document.getElementById("save20sub");
    const save30sub = document.getElementById("save30sub");

    const GROSS_NOMINAL = 0.08; // fixed 8%

    function clamp(v, lo, hi){ return Math.min(hi, Math.max(lo, v)); }

    function fmtCHF(x){
      if (!isFinite(x)) return "—";
      const rounded = Math.round(x);
      return "CHF " + rounded.toString().replace(/\B(?=(\d{3})+(?!\d))/g, "’");
    }

    // monthly future value with contributions at end of month
    // FV = PV*(1+r)^n + PMT * [((1+r)^n - 1)/r]
    function fv(PV, PMT, annualNet, years){
      const r = annualNet / 12;
      const n = Math.round(years * 12);
      if (n === 0) return PV;
      if (Math.abs(r) < 1e-12){
        return PV + PMT * n;
      }
      const pow = Math.pow(1 + r, n);
      return PV * pow + PMT * ((pow - 1) / r);
    }

    // build yearly points 0..30
    function series(PV, PMT, annualNet){
      const pts = [];
      for (let y=0; y<=30; y++){
        pts.push({y, v: fv(PV, PMT, annualNet, y)});
      }
      return pts;
    }

    function toPath(pts, x0, y0, w, h, vmax){
      // map y in [0,30] to x, value in [0,vmax] to y
      return pts.map((p,i)=>{
        const x = x0 + (p.y/30)*w;
        const y = y0 + h - (p.v/vmax)*h;
        return (i===0 ? "M" : "L") + x.toFixed(1) + "," + y.toFixed(1);
      }).join(" ");
    }

    function draw(){
      const PV = Math.max(0, Number(elLump.value || 0));
      const PMT = Math.max(0, Number(elMonthly.value || 0));
      const roboFee = clamp(Number(elRobo.value || 0) / 100, 0, 0.20);
      const bankFee = clamp(Number(elBank.value || 0) / 100, 0, 0.20);

      const rSelf = GROSS_NOMINAL;
      const rRobo = Math.max(-0.99, GROSS_NOMINAL - roboFee);
      const rBank = Math.max(-0.99, GROSS_NOMINAL - bankFee);

      const sSelf = series(PV, PMT, rSelf);
      const sRobo = series(PV, PMT, rRobo);
      const sBank = series(PV, PMT, rBank);

      const vmax = Math.max(
        sSelf[sSelf.length-1].v,
        sRobo[sRobo.length-1].v,
        sBank[sBank.length-1].v
      ) * 1.04;

      // svg frame
      const W = 780, H = 360;
      const padL = 70, padR = 40, padT = 34, padB = 54;
      const x0 = padL, y0 = padT, w = W - padL - padR, h = H - padT - padB;

      // helper to get y at year
      function yAt(seriesArr, year){
        const p = seriesArr.find(p=>p.y===year);
        return p ? (y0 + h - (p.v/vmax)*h) : (y0+h);
      }
      function vAt(seriesArr, year){
        const p = seriesArr.find(p=>p.y===year);
        return p ? p.v : 0;
      }

      // compute savings at 10/20/30
      function setSavings(year, elMain, elSub){
        const a = vAt(sSelf, year);
        const b = vAt(sRobo, year);
        const c = vAt(sBank, year);

        const saveVsRobo = a - b;
        const saveVsBank = a - c;

        elMain.textContent = fmtCHF(saveVsRobo);
        elSub.textContent = "vs robo: " + fmtCHF(saveVsRobo) + " • vs bank: " + fmtCHF(saveVsBank);
      }
      setSavings(10, save10, save10sub);
      setSavings(20, save20, save20sub);
      setSavings(30, save30, save30sub);

      // labels (difference annotations)
      const markYears = [10,20,30];

      const pathSelf = toPath(sSelf, x0, y0, w, h, vmax);
      const pathRobo = toPath(sRobo, x0, y0, w, h, vmax);
      const pathBank = toPath(sBank, x0, y0, w, h, vmax);

      // y grid labels: 0, 1/3, 2/3, 1.0 of chart height as money
      function moneyAtFrac(frac){
        return vmax * frac;
      }
      const yLabels = [
        {frac:0.00, txt:"0"},
        {frac:0.25, txt:fmtCHF(moneyAtFrac(0.25))},
        {frac:0.50, txt:fmtCHF(moneyAtFrac(0.50))},
        {frac:0.75, txt:fmtCHF(moneyAtFrac(0.75))},
        {frac:1.00, txt:fmtCHF(moneyAtFrac(1.00))}
      ];

      // build svg
      let g = "";
      // outer
      g += `<rect x="16" y="16" width="${W-32}" height="${H-32}" rx="16" fill="rgba(255,255,255,.65)" stroke="rgba(0,0,0,.10)"/>`;

      // grid
      for (let i=0;i<=4;i++){
        const yy = y0 + (h/4)*i;
        g += `<line x1="${x0}" y1="${yy}" x2="${x0+w}" y2="${yy}" stroke="rgba(0,0,0,.08)" stroke-width="1"/>`;
      }

      // axes
      g += `<line x1="${x0}" y1="${y0}" x2="${x0}" y2="${y0+h}" stroke="rgba(0,0,0,.18)" stroke-width="1.2"/>`;
      g += `<line x1="${x0}" y1="${y0+h}" x2="${x0+w}" y2="${y0+h}" stroke="rgba(0,0,0,.18)" stroke-width="1.2"/>`;

      // y labels
      yLabels.forEach((yl,i)=>{
        const yy = y0 + h - (h*(yl.frac));
        const t = (i===0) ? "0" : yl.txt;
        g += `<text x="${12}" y="${yy+4}" fill="rgba(0,0,0,.60)" font-size="11" font-family="ui-sans-serif,system-ui">${t}</text>`;
      });

      // x labels
      const xMarks = [0,10,20,30];
      xMarks.forEach(m=>{
        const xx = x0 + (m/30)*w;
        g += `<text x="${xx-8}" y="${y0+h+34}" fill="rgba(0,0,0,.60)" font-size="11" font-family="ui-sans-serif,system-ui">${m}y</text>`;
      });

      // title line
      g += `<text x="${x0}" y="${y0-10}" fill="rgba(0,0,0,.65)" font-size="12" font-family="ui-sans-serif,system-ui">
              ${fmtCHF(PV)} initial + ${fmtCHF(PMT).replace("CHF ","")} / month • 8% nominal (gross)
            </text>`;

      // paths
      g += `<path d="${pathSelf}" fill="none" stroke="#1f1f1f" stroke-width="3.8" stroke-linecap="round" stroke-linejoin="round"/>`;
      g += `<path d="${pathRobo}" fill="none" stroke="#c07a2a" stroke-width="3.8" stroke-linecap="round" stroke-linejoin="round"/>`;
      g += `<path d="${pathBank}" fill="none" stroke="rgba(31,31,31,.35)" stroke-width="3.8" stroke-linecap="round" stroke-linejoin="round"/>`;

      // annotations: vertical difference self vs robo and self vs bank at 10/20/30
      markYears.forEach(year=>{
        const xx = x0 + (year/30)*w;

        const ySelf = yAt(sSelf, year);
        const yRobo = yAt(sRobo, year);
        const yBank = yAt(sBank, year);

        const vSelf = vAt(sSelf, year);
        const vRobo = vAt(sRobo, year);
        const vBank = vAt(sBank, year);

        const dRobo = vSelf - vRobo;
        const dBank = vSelf - vBank;

        // draw two brackets: self vs robo (accent) and self vs bank (gray)
        const mid1 = (ySelf + yRobo)/2;
        const mid2 = (ySelf + yBank)/2;

        // Robo bracket
        g += `<line x1="${xx-8}" y1="${ySelf}" x2="${xx-8}" y2="${yRobo}" stroke="rgba(192,122,42,.95)" stroke-width="2"/>`;
        g += `<line x1="${xx-12}" y1="${ySelf}" x2="${xx-4}" y2="${ySelf}" stroke="rgba(192,122,42,.95)" stroke-width="2"/>`;
        g += `<line x1="${xx-12}" y1="${yRobo}" x2="${xx-4}" y2="${yRobo}" stroke="rgba(192,122,42,.95)" stroke-width="2"/>`;
        g += `<rect x="${xx-2}" y="${mid1-11}" width="120" height="22" rx="11" fill="rgba(255,255,255,.85)" stroke="rgba(0,0,0,.10)"/>`;
        g += `<text x="${xx+6}" y="${mid1+5}" fill="rgba(0,0,0,.75)" font-size="11" font-family="ui-sans-serif,system-ui">+${fmtCHF(dRobo).replace("CHF ","CHF ")}</text>`;

        // Bank bracket
        g += `<line x1="${xx+10}" y1="${ySelf}" x2="${xx+10}" y2="${yBank}" stroke="rgba(31,31,31,.40)" stroke-width="2"/>`;
        g += `<line x1="${xx+6}" y1="${ySelf}" x2="${xx+14}" y2="${ySelf}" stroke="rgba(31,31,31,.40)" stroke-width="2"/>`;
        g += `<line x1="${xx+6}" y1="${yBank}" x2="${xx+14}" y2="${yBank}" stroke="rgba(31,31,31,.40)" stroke-width="2"/>`;
        g += `<rect x="${xx+18}" y="${mid2-11}" width="120" height="22" rx="11" fill="rgba(255,255,255,.85)" stroke="rgba(0,0,0,.10)"/>`;
        g += `<text x="${xx+26}" y="${mid2+5}" fill="rgba(0,0,0,.75)" font-size="11" font-family="ui-sans-serif,system-ui">+${fmtCHF(dBank).replace("CHF ","CHF ")}</text>`;
      });

      // end dots
      const endX = x0 + w;
      const endSelfY = yAt(sSelf, 30), endRoboY = yAt(sRobo, 30), endBankY = yAt(sBank, 30);
      g += `<circle cx="${endX}" cy="${endSelfY}" r="4.8" fill="#1f1f1f"/>`;
      g += `<circle cx="${endX}" cy="${endRoboY}" r="4.8" fill="#c07a2a"/>`;
      g += `<circle cx="${endX}" cy="${endBankY}" r="4.8" fill="rgba(31,31,31,.35)"/>`;

      svg.innerHTML = g;
    }

    function hook(){
      [elLump, elMonthly, elRobo, elBank].forEach(el=>{
        el.addEventListener("input", draw);
        el.addEventListener("change", draw);
      });
      draw();
    }
    hook();
  </script>
</body>
</html>
